#!/usr/bin/env bash

set -e

SOURCE_PATH=@SOURCE_PATH@
INSTALL_PREFIX=@INSTALL_PREFIX@

export MACOSX_DEPLOYMENT_TARGET=14.6

cmake -G Ninja -S $SOURCE_PATH/llvm \
	-DCMAKE_INSTALL_PREFIX=$INSTALL_PREFIX \
	-DLLVM_ENABLE_RUNTIMES="libcxx;libcxxabi" \
	-DCMAKE_BUILD_TYPE=Release \
	-DLIBCXXABI_USE_LLVM_UNWINDER=OFF \
	-DLIBCXX_ENABLE_SHARED=false \
	-DLIBCXX_ENABLE_STATIC_ABI_LIBRARY=true

ninja runtimes

ninja install-cxx install-cxxabi
